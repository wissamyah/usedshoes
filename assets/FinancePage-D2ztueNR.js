import{c as K,r as I,j as e,X as Z,u as M,d as O,g as le,T as ie,W as X,D as V,e as Q,b as ee,S as te}from"./index-tPSreOsf.js";import{f as q}from"./dateFormatter-DEoQwZ0j.js";import{M as G}from"./Modal-DGs-dExx.js";import{S as $}from"./StatCard-BXT6fH2u.js";import{T as U}from"./trending-up-BqJ6wJKY.js";import{T as ne}from"./trending-down-DRbM4eBz.js";import{S as ce}from"./search-CqynyCyR.js";import{F as de}from"./file-text-D-n57aKz.js";import{U as oe}from"./users-siRg1z7g.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],re=K("building-2",pe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ae=K("pen",xe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=[["path",{d:"M11 17h3v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1v-3a3.16 3.16 0 0 0 2-2h1a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1h-1a5 5 0 0 0-2-4V3a4 4 0 0 0-3.2 1.6l-.3.4H11a6 6 0 0 0-6 6v1a5 5 0 0 0 2 4v3a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1z",key:"1piglc"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M2 8v1a2 2 0 0 0 2 2h1",key:"1env43"}]],ue=K("piggy-bank",be);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],se=K("user",he);function me({expectedBalance:d,onReconcile:y,onClose:k}){const[S,N]=I.useState(d.toString()),[C,u]=I.useState(""),n=2e3,p=parseFloat(S||0)-d,r=Math.max(0,parseFloat(S||0)-n),j=l=>{l.preventDefault(),y({actualCount:parseFloat(S),availableForDistribution:r,reservedAmount:n,notes:C.trim()})},b=l=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(l||0);return e.jsx(G,{isOpen:!0,onClose:k,size:"medium",children:e.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #404040",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 24px",borderBottom:"1px solid #404040"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#ebebeb"},children:"Daily Cash Reconciliation"}),e.jsx("button",{onClick:k,style:{color:"#b3b3b3",backgroundColor:"transparent",border:"none",borderRadius:"6px",padding:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:l=>{l.target.style.color="#ebebeb",l.target.style.backgroundColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:l=>{l.target.style.color="#b3b3b3",l.target.style.backgroundColor="transparent"},children:e.jsx(Z,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:j,style:{padding:"24px",display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Expected Balance"}),e.jsx("p",{style:{fontSize:"18px",fontWeight:"600",color:"#10b981"},children:b(d)})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Actual Count *"}),e.jsx("input",{type:"number",value:S,onChange:l=>N(l.target.value),step:"0.01",required:!0,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:l=>{l.target.style.borderColor="#60a5fa",l.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:l=>{l.target.style.borderColor="#404040",l.target.style.boxShadow="none"}})]}),p!==0&&e.jsx("div",{style:{padding:"12px",borderRadius:"6px",backgroundColor:p>0?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${p>0?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`},children:e.jsxs("p",{style:{fontSize:"14px",fontWeight:"500",color:p>0?"#22c55e":"#ef4444"},children:["Discrepancy: ",b(p)]})}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Notes"}),e.jsx("textarea",{value:C,onChange:l=>u(l.target.value),rows:3,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",resize:"vertical"},onFocus:l=>{l.target.style.borderColor="#60a5fa",l.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:l=>{l.target.style.borderColor="#404040",l.target.style.boxShadow="none"},placeholder:"Add any notes about the reconciliation..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"16px",borderTop:"1px solid #404040",marginTop:"8px"},children:[e.jsx("button",{type:"button",onClick:k,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#b3b3b3",backgroundColor:"transparent",border:"1px solid #404040",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:l=>{l.target.style.backgroundColor="rgba(255, 255, 255, 0.05)",l.target.style.color="#ebebeb"},onMouseLeave:l=>{l.target.style.backgroundColor="transparent",l.target.style.color="#b3b3b3"},children:"Cancel"}),e.jsx("button",{type:"submit",style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#ffffff",backgroundColor:"#3b82f6",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:l=>{l.target.style.backgroundColor="#2563eb"},onMouseLeave:l=>{l.target.style.backgroundColor="#3b82f6"},children:"Reconcile"})]})]})]})})}function ge({currentCashPosition:d,openingBalance:y}){const{sales:k,expenses:S,withdrawals:N,cashInjections:C=[],cashFlows:u,addCashFlow:n}=M(),{showSuccessMessage:p,showErrorMessage:r}=O(),[j,b]=I.useState(!1),l=new Date().toISOString().split("T")[0],w=k.filter(a=>a.date<l).reduce((a,z)=>a+(z.totalAmount||0),0),s=C.filter(a=>a.date<l).reduce((a,z)=>a+z.amount,0),f=S.filter(a=>a.date<l).reduce((a,z)=>a+z.amount,0),o=N.filter(a=>a.date<l).reduce((a,z)=>a+z.amount,0),m=w+s-f-o,D=k.filter(a=>a.date===l),t=S.filter(a=>a.date===l),x=N.filter(a=>a.date===l),i=C.filter(a=>a.date===l),g=D.reduce((a,z)=>a+(z.totalAmount||0),0),F=i.reduce((a,z)=>a+(z.amount||0),0),R=g+F,P=t.reduce((a,z)=>a+z.amount,0),W=x.reduce((a,z)=>a+z.amount,0),_=P+W,E=R-_,L=m+E,T=u.find(a=>a.date===l),J=T?.reconciled===!0,c=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a||0),v=async a=>{try{await n({date:l,openingBalance:m,cashSales:R,cashExpenses:P,withdrawals:x.map(z=>z.id),theoreticalBalance:L,actualCount:a.actualCount,actualBalance:a.actualCount,discrepancy:a.actualCount-L,availableForDistribution:a.availableForDistribution,reservedAmount:a.reservedAmount,notes:a.notes,reconciled:!0,reconciledBy:"Current User",reconciledAt:new Date().toISOString()}),p("Cash Reconciled","Daily cash flow has been reconciled successfully"),b(!1)}catch(z){r("Reconciliation Failed",z.message)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"500",color:"#ebebeb"},children:"Today's Cash Flow"}),e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3",marginTop:"4px"},children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),!J&&e.jsx("button",{onClick:()=>b(!0),style:{display:"inline-flex",alignItems:"center",padding:"8px 16px",border:"none",fontSize:"14px",fontWeight:"500",borderRadius:"6px",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)",color:"white",backgroundColor:"#3b82f6",cursor:"pointer",transition:"background-color 0.2s"},onMouseEnter:a=>{a.target.style.backgroundColor="#2563eb"},onMouseLeave:a=>{a.target.style.backgroundColor="#3b82f6"},children:"Reconcile Cash"})]}),J?e.jsxs("div",{style:{marginBottom:"24px",backgroundColor:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:"8px",padding:"16px",display:"flex",alignItems:"center"},children:[e.jsx(le,{style:{height:"20px",width:"20px",color:"#22c55e",marginRight:"12px"}}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#22c55e"},children:"Cash Reconciled"}),e.jsxs("p",{style:{fontSize:"14px",color:"#16a34a"},children:["Today's cash has been reconciled. Actual: ",c(T.actualCount)," | Discrepancy: ",c(T.discrepancy)]})]})]}):e.jsxs("div",{style:{marginBottom:"24px",backgroundColor:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:"8px",padding:"16px",display:"flex",alignItems:"center"},children:[e.jsx(ie,{style:{height:"20px",width:"20px",color:"#f59e0b",marginRight:"12px"}}),e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#f59e0b"},children:"Pending Reconciliation"}),e.jsx("p",{style:{fontSize:"14px",color:"#d97706"},children:"Please reconcile today's cash before closing"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx($,{title:"Opening Balance",value:c(m),subtitle:"Balance at start of today",icon:X,iconBgColor:"bg-gray-100",iconColor:"text-gray-600"}),e.jsx($,{title:"Cash Inflows",value:`+${c(R)}`,subtitle:`Sales: ${c(g)} • Injections: ${c(F)}`,icon:U,iconBgColor:"bg-green-100",iconColor:"text-green-600",trend:R>0?"up":null}),e.jsx($,{title:"Cash Outflows",value:`-${c(_)}`,subtitle:`Expenses: ${c(P)} • Withdrawals: ${c(W)}`,icon:ne,iconBgColor:"bg-red-100",iconColor:"text-red-600",trend:_>0?"down":null}),e.jsx($,{title:"Expected Balance",value:c(L),subtitle:`Net: ${E>=0?"+":""}${c(E)}`,icon:V,iconBgColor:"bg-blue-100",iconColor:"text-blue-600",trend:E>0?"up":E<0?"down":null})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{style:{backgroundColor:"#2a2a2a",borderRadius:"8px",border:"1px solid #404040"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #404040"},children:e.jsx("h4",{style:{fontSize:"14px",fontWeight:"500",color:"#ebebeb"},children:"Cash Inflows by Date"})}),e.jsx("div",{className:"p-4",children:(()=>{const a={};k.forEach(h=>{a[h.date]||(a[h.date]={sales:0,injections:0,count:0}),a[h.date].sales+=h.totalAmount||0,a[h.date].count+=1}),C.forEach(h=>{a[h.date]||(a[h.date]={sales:0,injections:0,count:0}),a[h.date].injections+=h.amount||0,a[h.date].count+=1});const A=Object.keys(a).sort((h,B)=>B.localeCompare(h)).slice(0,10);return A.length===0?e.jsx("p",{style:{fontSize:"14px",color:"#808080"},children:"No cash inflows recorded"}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto custom-scrollbar",children:A.map(h=>{const B=a[h],Y=B.sales+B.injections,H=h===l;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",...H?{backgroundColor:"rgba(59, 130, 246, 0.1)",padding:"8px",borderRadius:"4px"}:{}},children:[e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:"14px",fontWeight:"500",color:"#ebebeb"},children:[q(h)," ",H&&e.jsx("span",{style:{fontSize:"12px",color:"#60a5fa",marginLeft:"4px"},children:"(Today)"})]}),e.jsxs("p",{style:{fontSize:"12px",color:"#b3b3b3"},children:[B.count," transaction",B.count!==1?"s":"",B.sales>0&&` • Sales: ${c(B.sales)}`,B.injections>0&&` • Injections: ${c(B.injections)}`]})]}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"500",color:"#22c55e"},children:["+",c(Y)]})]},h)})})})()})]}),e.jsxs("div",{style:{backgroundColor:"#2a2a2a",borderRadius:"8px",border:"1px solid #404040"},children:[e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid #404040"},children:e.jsx("h4",{style:{fontSize:"14px",fontWeight:"500",color:"#ebebeb"},children:"Cash Outflows by Date"})}),e.jsx("div",{className:"p-4",children:(()=>{const a={};S.forEach(h=>{a[h.date]||(a[h.date]={expenses:0,withdrawals:0,count:0}),a[h.date].expenses+=h.amount||0,a[h.date].count+=1}),N.forEach(h=>{a[h.date]||(a[h.date]={expenses:0,withdrawals:0,count:0}),a[h.date].withdrawals+=h.amount||0,a[h.date].count+=1});const A=Object.keys(a).sort((h,B)=>B.localeCompare(h)).slice(0,10);return A.length===0?e.jsx("p",{style:{fontSize:"14px",color:"#808080"},children:"No cash outflows recorded"}):e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto custom-scrollbar",children:A.map(h=>{const B=a[h],Y=B.expenses+B.withdrawals,H=h===l;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",...H?{backgroundColor:"rgba(239, 68, 68, 0.1)",padding:"8px",borderRadius:"4px"}:{}},children:[e.jsxs("div",{children:[e.jsxs("p",{style:{fontSize:"14px",fontWeight:"500",color:"#ebebeb"},children:[q(h)," ",H&&e.jsx("span",{style:{fontSize:"12px",color:"#ef4444",marginLeft:"4px"},children:"(Today)"})]}),e.jsxs("p",{style:{fontSize:"12px",color:"#b3b3b3"},children:[B.count," transaction",B.count!==1?"s":"",B.expenses>0&&` • Expenses: ${c(B.expenses)}`,B.withdrawals>0&&` • Withdrawals: ${c(B.withdrawals)}`]})]}),e.jsxs("span",{style:{fontSize:"14px",fontWeight:"500",color:"#ef4444"},children:["-",c(Y)]})]},h)})})})()})]})]}),j&&e.jsx(me,{expectedBalance:L,onReconcile:v,onClose:()=>b(!1)})]})}function ye({availableCash:d,onClose:y}){const{partners:k,addWithdrawal:S}=M(),{showSuccessMessage:N,showErrorMessage:C}=O(),[u,n]=I.useState({partnerId:"",amount:"",type:"personal",purpose:"",notes:"",date:new Date().toISOString().split("T")[0],time:new Date().toTimeString().split(" ")[0].substring(0,5)}),[p,r]=I.useState({}),[j,b]=I.useState(!1),l=[{value:"personal",label:"Personal Draw"},{value:"business_expense",label:"Business Expense"},{value:"profit_distribution",label:"Profit Distribution"},{value:"loan",label:"Loan"}],w=async s=>{s.preventDefault();const f={};if(u.partnerId||(f.partnerId="Please select a partner"),!u.amount||parseFloat(u.amount)<=0?f.amount="Amount must be greater than 0":parseFloat(u.amount)>d&&(f.amount=`Cannot exceed available cash (${d.toFixed(2)})`),u.purpose||(f.purpose="Purpose is required"),Object.keys(f).length>0){r(f);return}b(!0);try{const o=k.find(m=>m.id===u.partnerId);await S({partnerId:u.partnerId,partnerName:o?.name||"Unknown",amount:parseFloat(u.amount),type:u.type,purpose:u.purpose,notes:u.notes,date:u.date,time:u.time}),N("Withdrawal Recorded","The withdrawal has been recorded successfully"),y()}catch(o){C("Operation Failed",o.message)}finally{b(!1)}};return e.jsx(G,{isOpen:!0,onClose:y,size:"medium",children:e.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #404040",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 24px",borderBottom:"1px solid #404040"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#ebebeb"},children:"Record Withdrawal"}),e.jsx("button",{onClick:y,style:{color:"#b3b3b3",backgroundColor:"transparent",border:"none",borderRadius:"6px",padding:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:s=>{s.target.style.color="#ebebeb",s.target.style.backgroundColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:s=>{s.target.style.color="#b3b3b3",s.target.style.backgroundColor="transparent"},children:e.jsx(Z,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:w,style:{padding:"24px",display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Partner *"}),e.jsxs("select",{value:u.partnerId,onChange:s=>n({...u,partnerId:s.target.value}),style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:p.partnerId?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:s=>{s.target.style.borderColor=p.partnerId?"#ef4444":"#60a5fa",s.target.style.boxShadow=p.partnerId?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:s=>{s.target.style.borderColor=p.partnerId?"#ef4444":"#404040",s.target.style.boxShadow="none"},children:[e.jsx("option",{value:"",children:"Select partner..."}),k.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.ownershipPercent,"%)"]},s.id))]}),p.partnerId&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:p.partnerId})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Amount ($) *"}),e.jsx("input",{type:"number",value:u.amount,onChange:s=>n({...u,amount:s.target.value}),step:"0.01",min:"0",style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:p.amount?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:s=>{s.target.style.borderColor=p.amount?"#ef4444":"#60a5fa",s.target.style.boxShadow=p.amount?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:s=>{s.target.style.borderColor=p.amount?"#ef4444":"#404040",s.target.style.boxShadow="none"}}),p.amount&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:p.amount}),e.jsxs("p",{style:{marginTop:"4px",fontSize:"12px",color:"#22c55e"},children:["Available: $",d.toFixed(2)]})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Type *"}),e.jsx("select",{value:u.type,onChange:s=>n({...u,type:s.target.value}),style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:s=>{s.target.style.borderColor="#60a5fa",s.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:s=>{s.target.style.borderColor="#404040",s.target.style.boxShadow="none"},children:l.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Purpose *"}),e.jsx("input",{type:"text",value:u.purpose,onChange:s=>n({...u,purpose:s.target.value}),style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:p.purpose?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:s=>{s.target.style.borderColor=p.purpose?"#ef4444":"#60a5fa",s.target.style.boxShadow=p.purpose?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:s=>{s.target.style.borderColor=p.purpose?"#ef4444":"#404040",s.target.style.boxShadow="none"}}),p.purpose&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:p.purpose})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Notes"}),e.jsx("textarea",{value:u.notes,onChange:s=>n({...u,notes:s.target.value}),rows:3,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",resize:"vertical"},onFocus:s=>{s.target.style.borderColor="#60a5fa",s.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:s=>{s.target.style.borderColor="#404040",s.target.style.boxShadow="none"}})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"16px",borderTop:"1px solid #404040",marginTop:"8px"},children:[e.jsx("button",{type:"button",onClick:y,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#b3b3b3",backgroundColor:"transparent",border:"1px solid #404040",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:s=>{s.target.style.backgroundColor="rgba(255, 255, 255, 0.05)",s.target.style.color="#ebebeb"},onMouseLeave:s=>{s.target.style.backgroundColor="transparent",s.target.style.color="#b3b3b3"},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:j,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#ffffff",backgroundColor:"#22c55e",border:"none",borderRadius:"6px",cursor:j?"not-allowed":"pointer",opacity:j?.5:1,transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:s=>{j||(s.target.style.backgroundColor="#16a34a")},onMouseLeave:s=>{j||(s.target.style.backgroundColor="#22c55e")},children:j?"Recording...":"Record Withdrawal"})]})]})]})})}function fe({availableCash:d}){const{partners:y,withdrawals:k,deleteWithdrawal:S}=M(),{showConfirmDialog:N,showSuccessMessage:C,showErrorMessage:u}=O(),[n,p]=I.useState(!1),[r,j]=I.useState(""),[b,l]=I.useState(""),[w,s]=I.useState(""),f=k.filter(t=>{const x=!r||t.purpose?.toLowerCase().includes(r.toLowerCase())||t.notes?.toLowerCase().includes(r.toLowerCase()),i=!b||t.partnerId===b,g=!w||t.type===w;return x&&i&&g}).sort((t,x)=>new Date(x.date)-new Date(t.date)),o=async t=>{if(await N("Delete Withdrawal",`Are you sure you want to delete this $${t.amount} withdrawal? This will update the partner's capital account.`,"danger"))try{await S(t.id),C("Withdrawal Deleted","The withdrawal has been removed and capital account updated")}catch(i){u("Delete Failed",i.message)}},m=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0),D=f.reduce((t,x)=>t+x.amount,0);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"500",color:"#ebebeb"},children:"Withdrawal History"}),e.jsxs("p",{style:{fontSize:"14px",color:"#b3b3b3",marginTop:"4px"},children:[f.length," withdrawals • ",m(D)," total"]})]}),e.jsxs("button",{onClick:()=>p(!0),disabled:y.length===0||d<=0,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Record Withdrawal"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(ce,{className:"h-5 w-5 absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search withdrawals...",value:r,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-md",style:{backgroundColor:"#3a3a3a",border:"1px solid #525252",color:"#ebebeb"}})]})}),e.jsxs("select",{value:b,onChange:t=>l(t.target.value),className:"px-3 py-2 rounded-md",style:{backgroundColor:"#3a3a3a",border:"1px solid #525252",color:"#ebebeb"},children:[e.jsx("option",{value:"",children:"All Partners"}),y.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:w,onChange:t=>s(t.target.value),className:"px-3 py-2 rounded-md",style:{backgroundColor:"#3a3a3a",border:"1px solid #525252",color:"#ebebeb"},children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"personal",children:"Personal Draw"}),e.jsx("option",{value:"business_expense",children:"Business Expense"}),e.jsx("option",{value:"profit_distribution",children:"Profit Distribution"}),e.jsx("option",{value:"loan",children:"Loan"})]})]}),f.length===0?e.jsx("div",{style:{textAlign:"center",padding:"48px 0",backgroundColor:"#3a3a3a",border:"1px solid #525252",borderRadius:"8px"},children:e.jsx("p",{style:{color:"#9ca3af"},children:"No withdrawals found"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",style:{backgroundColor:"#3a3a3a",borderRadius:"8px",overflow:"hidden"},children:[e.jsx("thead",{style:{backgroundColor:"#2a2a2a"},children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",style:{color:"#9ca3af"},children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",style:{color:"#9ca3af"},children:"Partner"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",style:{color:"#9ca3af"},children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",style:{color:"#9ca3af"},children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",style:{color:"#9ca3af"},children:"Purpose"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase",style:{color:"#9ca3af"},children:"Actions"})]})}),e.jsx("tbody",{children:f.map(t=>e.jsxs("tr",{style:{borderBottom:"1px solid #404040"},onMouseEnter:x=>{x.currentTarget.style.backgroundColor="#4a4a4a"},onMouseLeave:x=>{x.currentTarget.style.backgroundColor="transparent"},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",style:{color:"#ebebeb"},children:q(t.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",style:{color:"#ebebeb"},children:t.partnerName}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",style:{color:"#ebebeb"},children:m(t.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:t.type?.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4 text-sm",style:{color:"#ebebeb"},children:t.purpose}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>o(t),className:"hover:text-red-400",style:{color:"#9ca3af"},children:e.jsx(ee,{className:"h-4 w-4"})})})]},t.id))})]})}),n&&e.jsx(ye,{availableCash:d,onClose:()=>p(!1)})]})}function je({partner:d,onClose:y}){const{partners:k,addPartner:S,updatePartner:N}=M(),{showSuccessMessage:C,showErrorMessage:u}=O(),[n,p]=I.useState({name:d?.name||"",email:d?.email||"",phoneNumber:d?.phoneNumber||"",ownershipPercent:d?.ownershipPercent?.toString()||"",initialInvestment:d?.capitalAccount?.initialInvestment?.toString()||"0",bankDetails:{accountName:d?.bankDetails?.accountName||"",accountNumber:d?.bankDetails?.accountNumber||"",bankName:d?.bankDetails?.bankName||""}}),[r,j]=I.useState({}),[b,l]=I.useState(!1),w=o=>{const{name:m,value:D}=o.target;if(m.startsWith("bank_")){const t=m.replace("bank_","");p(x=>({...x,bankDetails:{...x.bankDetails,[t]:D}}))}else p(t=>({...t,[m]:D}));r[m]&&j(t=>{const x={...t};return delete x[m],x})},s=()=>{const o={};if(n.name.trim()||(o.name="Partner name is required"),!n.ownershipPercent)o.ownershipPercent="Ownership percentage is required";else{const m=parseFloat(n.ownershipPercent);(m<=0||m>100)&&(o.ownershipPercent="Must be between 0 and 100");const D=k.filter(t=>t.id!==d?.id).reduce((t,x)=>t+(x.ownershipPercent||0),0);D+m>100&&(o.ownershipPercent=`Total ownership would exceed 100% (current: ${D}%)`)}return n.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n.email)&&(o.email="Invalid email format"),n.initialInvestment&&parseFloat(n.initialInvestment)<0&&(o.initialInvestment="Investment cannot be negative"),j(o),Object.keys(o).length===0},f=async o=>{if(o.preventDefault(),!!s()){l(!0);try{const m={name:n.name.trim(),email:n.email.trim(),phoneNumber:n.phoneNumber.trim(),ownershipPercent:parseFloat(n.ownershipPercent),initialInvestment:parseFloat(n.initialInvestment||0),bankDetails:{accountName:n.bankDetails.accountName.trim(),accountNumber:n.bankDetails.accountNumber.trim(),bankName:n.bankDetails.bankName.trim()}};d?(await N(d.id,m),C("Partner Updated",`${m.name}'s information has been updated`)):(await S(m),C("Partner Added",`${m.name} has been added successfully`)),y()}catch(m){console.error("Partner form submission error:",m),u("Operation Failed",m.message||"Failed to save partner")}finally{l(!1)}}};return e.jsx(G,{isOpen:!0,onClose:y,size:"medium",children:e.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #404040",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 24px",borderBottom:"1px solid #404040"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#ebebeb"},children:d?"Edit Partner":"Add New Partner"}),e.jsx("button",{onClick:y,style:{color:"#b3b3b3",backgroundColor:"transparent",border:"none",borderRadius:"6px",padding:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:o=>{o.target.style.color="#ebebeb",o.target.style.backgroundColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:o=>{o.target.style.color="#b3b3b3",o.target.style.backgroundColor="transparent"},children:e.jsx(Z,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:f,style:{padding:"24px",display:"flex",flexDirection:"column",gap:"24px"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#ebebeb",marginBottom:"16px"},children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Full Name *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:n.name,onChange:w,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.name?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor=r.name?"#ef4444":"#60a5fa",o.target.style.boxShadow=r.name?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor=r.name?"#ef4444":"#404040",o.target.style.boxShadow="none"},placeholder:"Partner name"}),r.name&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ownershipPercent",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Ownership (%) *"}),e.jsx("input",{type:"number",id:"ownershipPercent",name:"ownershipPercent",value:n.ownershipPercent,onChange:w,min:"0",max:"100",step:"0.01",style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.ownershipPercent?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor=r.ownershipPercent?"#ef4444":"#60a5fa",o.target.style.boxShadow=r.ownershipPercent?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor=r.ownershipPercent?"#ef4444":"#404040",o.target.style.boxShadow="none"},placeholder:"50"}),r.ownershipPercent&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.ownershipPercent})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#ebebeb",marginBottom:"16px"},children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:w,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.email?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor=r.email?"#ef4444":"#60a5fa",o.target.style.boxShadow=r.email?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor=r.email?"#ef4444":"#404040",o.target.style.boxShadow="none"},placeholder:"Email address"}),r.email&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.email})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phoneNumber",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:n.phoneNumber,onChange:w,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor="#60a5fa",o.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor="#404040",o.target.style.boxShadow="none"},placeholder:"Phone number"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#ebebeb",marginBottom:"16px"},children:"Financial Information"}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"initialInvestment",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Initial Investment ($)"}),e.jsx("input",{type:"number",id:"initialInvestment",name:"initialInvestment",value:n.initialInvestment,onChange:w,min:"0",step:"0.01",style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.initialInvestment?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor=r.initialInvestment?"#ef4444":"#60a5fa",o.target.style.boxShadow=r.initialInvestment?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor=r.initialInvestment?"#ef4444":"#404040",o.target.style.boxShadow="none"},placeholder:"Initial investment"}),r.initialInvestment&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.initialInvestment})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:"16px",fontWeight:"600",color:"#ebebeb",marginBottom:"16px"},children:"Bank Details (Optional)"}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bank_accountName",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Account Name"}),e.jsx("input",{type:"text",id:"bank_accountName",name:"bank_accountName",value:n.bankDetails.accountName,onChange:w,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor="#60a5fa",o.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor="#404040",o.target.style.boxShadow="none"},placeholder:"Partner name"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bank_bankName",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Bank Name"}),e.jsx("input",{type:"text",id:"bank_bankName",name:"bank_bankName",value:n.bankDetails.bankName,onChange:w,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor="#60a5fa",o.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor="#404040",o.target.style.boxShadow="none"},placeholder:"Bank name"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bank_accountNumber",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Account Number"}),e.jsx("input",{type:"text",id:"bank_accountNumber",name:"bank_accountNumber",value:n.bankDetails.accountNumber,onChange:w,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:o=>{o.target.style.borderColor="#60a5fa",o.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:o=>{o.target.style.borderColor="#404040",o.target.style.boxShadow="none"},placeholder:"Account number"})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"16px",borderTop:"1px solid #404040",marginTop:"8px"},children:[e.jsx("button",{type:"button",onClick:y,disabled:b,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#b3b3b3",backgroundColor:"transparent",border:"1px solid #404040",borderRadius:"6px",cursor:b?"not-allowed":"pointer",opacity:b?.5:1,transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:o=>{b||(o.target.style.backgroundColor="rgba(255, 255, 255, 0.05)",o.target.style.color="#ebebeb")},onMouseLeave:o=>{b||(o.target.style.backgroundColor="transparent",o.target.style.color="#b3b3b3")},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#ffffff",backgroundColor:"#3b82f6",border:"none",borderRadius:"6px",cursor:b?"not-allowed":"pointer",opacity:b?.5:1,transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:o=>{b||(o.target.style.backgroundColor="#2563eb")},onMouseLeave:o=>{b||(o.target.style.backgroundColor="#3b82f6")},children:b?"Saving...":d?"Update Partner":"Add Partner"})]})]})]})})}function we({partner:d,onClose:y}){const{withdrawals:k}=M(),S=k.filter(p=>p.partnerId===d.id).sort((p,r)=>new Date(r.date)-new Date(p.date)),N=d.capitalAccount||{},C=S.reduce((p,r)=>p+r.amount,0),u=(N.initialInvestment||0)+(N.profitShare||0)-C,n=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p||0);return e.jsx(G,{isOpen:!0,onClose:y,size:"large",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:d.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[d.ownershipPercent,"% Partner"]})]}),e.jsx("button",{onClick:y,className:"text-gray-400 hover:text-gray-600",children:e.jsx(Z,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Capital Account"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Initial Investment"}),e.jsx("span",{className:"text-sm font-medium",children:n(N.initialInvestment||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Profit Share"}),e.jsx("span",{className:"text-sm font-medium",children:n(N.profitShare||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Withdrawn"}),e.jsxs("span",{className:"text-sm font-medium text-red-600",children:["-",n(C)]})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Current Equity"}),e.jsx("span",{className:`text-base font-semibold ${u>=0?"text-green-600":"text-red-600"}`,children:n(u)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-base font-medium text-gray-900 mb-4",children:"Recent Withdrawals"}),S.length===0?e.jsx("p",{className:"text-sm text-gray-500",children:"No withdrawals recorded"}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:S.slice(0,10).map(p=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:n(p.amount)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[p.type," - ",p.purpose]})]}),e.jsx("span",{className:"text-sm text-gray-600",children:q(p.date)})]},p.id))})]})]})]})})}function ve(){const{partners:d,withdrawals:y,deletePartner:k}=M(),{showConfirmDialog:S,showSuccessMessage:N,showErrorMessage:C}=O(),[u,n]=I.useState(!1),[p,r]=I.useState(null),[j,b]=I.useState(null),l=()=>{r(null),n(!0)},w=t=>{r(t),n(!0)},s=t=>{b(t)},f=async t=>{const x=y.filter(g=>g.partnerId===t.id);if(x.length>0){C("Cannot Delete Partner",`${t.name} has ${x.length} withdrawal records. Archive partner instead.`);return}if(await S("Delete Partner",`Are you sure you want to delete ${t.name}? This action cannot be undone.`,"danger"))try{await k(t.id),N("Partner Deleted",`${t.name} has been removed`)}catch(g){C("Delete Failed",g.message)}},o=t=>{console.log(`📊 Calculating metrics for partner: ${t.name} (${t.id})`),console.log(`📊 Total withdrawals in system: ${y?.length||0}`),console.log("📊 All withdrawals:",y);const x=y.filter(P=>P.partnerId===t.id);console.log(`📊 Partner ${t.id} withdrawals:`,x);const i=x.reduce((P,W)=>P+W.amount,0),g=x.sort((P,W)=>new Date(W.date)-new Date(P.date))[0],F=t.capitalAccount||{},R=(F.initialInvestment||0)+(F.profitShare||0)-i;return console.log(`📊 Partner ${t.id} metrics: totalWithdrawn=${i}, equity=${R}`),{totalWithdrawn:i,lastWithdrawal:g,currentEquity:R,withdrawalCount:x.length}},m=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0),D=t=>t?q(t):"Never";return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"500",color:"#ebebeb"},children:"Partners"}),e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3",marginTop:"4px"},children:"Manage partner profiles and equity accounts"})]}),e.jsxs("button",{onClick:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Add Partner"]})]}),d.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"48px 0",backgroundColor:"#3a3a3a",border:"2px dashed #525252",borderRadius:"8px"},children:[e.jsx(se,{className:"mx-auto h-12 w-12",style:{color:"#6b7280"}}),e.jsx("h3",{className:"mt-2 text-sm font-medium",style:{color:"#ebebeb"},children:"No Partners"}),e.jsx("p",{className:"mt-1 text-sm",style:{color:"#9ca3af"},children:"No partners added."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(t=>{const x=o(t),i=x.currentEquity>=0;return e.jsx("div",{style:{backgroundColor:"#3a3a3a",border:"1px solid #525252",borderRadius:"8px",boxShadow:"0 1px 3px 0 rgba(0, 0, 0, 0.2)",transition:"box-shadow 0.3s"},onMouseEnter:g=>{g.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.4)"},onMouseLeave:g=>{g.currentTarget.style.boxShadow="0 1px 3px 0 rgba(0, 0, 0, 0.2)"},children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(se,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-lg font-medium",style:{color:"#ebebeb"},children:t.name}),e.jsxs("p",{className:"text-sm",style:{color:"#9ca3af"},children:[t.ownershipPercent,"% ownership"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>s(t),className:"hover:text-blue-400 p-1",style:{color:"#2563eb"},title:"View details",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>w(t),className:"hover:text-gray-400 p-1",style:{color:"#9ca3af"},title:"Edit partner",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>f(t),className:"hover:text-red-400 p-1",style:{color:"#dc2626"},title:"Delete partner",children:e.jsx(ee,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",style:{color:"#b3b3b3"},children:"Current Equity"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`text-lg font-semibold ${i?"text-green-600":"text-red-600"}`,children:m(x.currentEquity)}),i?e.jsx(U,{className:"h-4 w-4 text-green-600 ml-1"}):e.jsx(ne,{className:"h-4 w-4 text-red-600 ml-1"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",style:{color:"#b3b3b3"},children:"Initial Investment"}),e.jsx("span",{className:"text-sm font-medium",style:{color:"#ebebeb"},children:m(t.capitalAccount?.initialInvestment||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",style:{color:"#b3b3b3"},children:"Total Withdrawn"}),e.jsx("span",{className:"text-sm font-medium",style:{color:"#ebebeb"},children:m(x.totalWithdrawn)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm",style:{color:"#b3b3b3"},children:"Last Withdrawal"}),e.jsx("span",{className:"text-sm",style:{color:"#9ca3af"},children:D(x.lastWithdrawal?.date)})]})]}),(t.email||t.phoneNumber)&&e.jsxs("div",{className:"mt-4 pt-4",style:{borderTop:"1px solid #404040"},children:[t.email&&e.jsxs("p",{className:"text-sm truncate",style:{color:"#b3b3b3"},children:["📧 ",t.email]}),t.phoneNumber&&e.jsxs("p",{className:"text-sm mt-1",style:{color:"#b3b3b3"},children:["📱 ",t.phoneNumber]})]})]})},t.id)})}),u&&e.jsx(je,{partner:p,onClose:()=>{n(!1),r(null)}}),j&&e.jsx(we,{partner:j,onClose:()=>b(null)})]})}function Ce({injection:d,onClose:y}){const{partners:k,addCashInjection:S,updateCashInjection:N}=M(),{showSuccessMessage:C,showErrorMessage:u}=O(),[n,p]=I.useState({type:d?.type||"Capital Contribution",amount:d?.amount?.toString()||"",date:d?.date||new Date().toISOString().split("T")[0],source:d?.source||"",description:d?.description||"",reference:d?.reference||"",partnerId:d?.partnerId||"",notes:d?.notes||""}),[r,j]=I.useState({}),[b,l]=I.useState(!1),w=[{value:"Capital Contribution",label:"Capital Contribution",requiresPartner:!0},{value:"Loan",label:"Loan/Financing",requiresPartner:!1},{value:"Other Income",label:"Other Income",requiresPartner:!1},{value:"Opening Balance",label:"Opening Balance Adjustment",requiresPartner:!1}],s=w.find(t=>t.value===n.type),f=t=>{const{name:x,value:i}=t.target;p(g=>({...g,[x]:i})),r[x]&&j(g=>({...g,[x]:""})),x==="type"&&(w.find(F=>F.value===i)?.requiresPartner||p(F=>({...F,partnerId:""})))},o=()=>{const t={};return n.type||(t.type="Please select an injection type"),n.amount?parseFloat(n.amount)<=0&&(t.amount="Amount must be greater than 0"):t.amount="Amount is required",n.date||(t.date="Date is required"),n.source.trim()||(t.source="Source is required"),s?.requiresPartner&&!n.partnerId&&(t.partnerId="Please select a partner for capital contribution"),n.description.trim()||(t.description="Description is required"),j(t),Object.keys(t).length===0},m=async t=>{if(t.preventDefault(),!!o()){l(!0);try{const x={type:n.type,amount:parseFloat(n.amount),date:n.date,source:n.source.trim(),description:n.description.trim(),reference:n.reference.trim(),partnerId:n.partnerId||null,notes:n.notes.trim()};d?(await N(d.id,x),C("Cash Injection Updated","Cash injection has been updated successfully")):(await S(x),C("Cash Injection Added","New cash injection has been recorded successfully")),y()}catch(x){console.error("Cash injection submission error:",x),u("Submission Failed",x.message||"Failed to record cash injection")}finally{l(!1)}}},D=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0);return e.jsx(G,{isOpen:!0,onClose:y,size:"medium",children:e.jsxs("div",{style:{backgroundColor:"#2a2a2a",border:"1px solid #404040",borderRadius:"8px",padding:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"24px"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"600",color:"#ebebeb"},children:d?"Edit Cash Injection":"Add Cash Injection"}),e.jsxs("button",{onClick:y,style:{color:"#b3b3b3",backgroundColor:"transparent",border:"none",borderRadius:"6px",padding:"8px",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:t=>{t.target.style.color="#ebebeb",t.target.style.backgroundColor="rgba(255, 255, 255, 0.1)"},onMouseLeave:t=>{t.target.style.color="#b3b3b3",t.target.style.backgroundColor="transparent"},children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(Z,{className:"h-6 w-6"})]})]}),e.jsxs("form",{onSubmit:m,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"type",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Injection Type *"}),e.jsx("select",{id:"type",name:"type",value:n.type,onChange:f,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.type?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor=r.type?"#ef4444":"#60a5fa",t.target.style.boxShadow=r.type?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor=r.type?"#ef4444":"#404040",t.target.style.boxShadow="none"},children:w.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),r.type&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.type})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Amount ($) *"}),e.jsx("input",{type:"number",id:"amount",name:"amount",value:n.amount,onChange:f,min:"0",step:"0.01",style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.amount?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor=r.amount?"#ef4444":"#60a5fa",t.target.style.boxShadow=r.amount?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor=r.amount?"#ef4444":"#404040",t.target.style.boxShadow="none"},placeholder:"0.00"}),r.amount&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.amount})]})]}),s?.requiresPartner&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"partnerId",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Partner *"}),e.jsxs("select",{id:"partnerId",name:"partnerId",value:n.partnerId,onChange:f,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.partnerId?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor=r.partnerId?"#ef4444":"#60a5fa",t.target.style.boxShadow=r.partnerId?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor=r.partnerId?"#ef4444":"#404040",t.target.style.boxShadow="none"},children:[e.jsx("option",{value:"",children:"Select a partner"}),k.map(t=>e.jsxs("option",{value:t.id,children:[t.name," (",t.ownershipPercent,"%)"]},t.id))]}),r.partnerId&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.partnerId})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"source",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Source *"}),e.jsx("input",{type:"text",id:"source",name:"source",value:n.source,onChange:f,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.source?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor=r.source?"#ef4444":"#60a5fa",t.target.style.boxShadow=r.source?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor=r.source?"#ef4444":"#404040",t.target.style.boxShadow="none"},placeholder:"Source"}),r.source&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.source})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Date *"}),e.jsx("input",{type:"date",id:"date",name:"date",value:n.date,onChange:f,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.date?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor=r.date?"#ef4444":"#60a5fa",t.target.style.boxShadow=r.date?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor=r.date?"#ef4444":"#404040",t.target.style.boxShadow="none"}}),r.date&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.date})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Description *"}),e.jsx("input",{type:"text",id:"description",name:"description",value:n.description,onChange:f,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:r.description?"1px solid #ef4444":"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor=r.description?"#ef4444":"#60a5fa",t.target.style.boxShadow=r.description?"0 0 0 3px rgba(239, 68, 68, 0.1)":"0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor=r.description?"#ef4444":"#404040",t.target.style.boxShadow="none"},placeholder:"Description"}),r.description&&e.jsx("p",{style:{marginTop:"4px",fontSize:"14px",color:"#ef4444"},children:r.description})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reference",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Reference Number"}),e.jsx("input",{type:"text",id:"reference",name:"reference",value:n.reference,onChange:f,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onFocus:t=>{t.target.style.borderColor="#60a5fa",t.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor="#404040",t.target.style.boxShadow="none"},placeholder:"Reference number"}),e.jsx("p",{style:{marginTop:"4px",fontSize:"12px",color:"#b3b3b3"},children:"Optional reference for tracking"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",style:{display:"block",fontSize:"14px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"Additional Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:n.notes,onChange:f,rows:3,style:{width:"100%",padding:"12px",fontSize:"14px",backgroundColor:"#1c1c1c",color:"#ebebeb",border:"1px solid #404040",borderRadius:"6px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",resize:"vertical"},onFocus:t=>{t.target.style.borderColor="#60a5fa",t.target.style.boxShadow="0 0 0 3px rgba(96, 165, 250, 0.1)"},onBlur:t=>{t.target.style.borderColor="#404040",t.target.style.boxShadow="none"},placeholder:"Notes"})]}),n.amount&&e.jsxs("div",{style:{backgroundColor:"rgba(34, 197, 94, 0.1)",borderRadius:"8px",padding:"16px",border:"1px solid rgba(34, 197, 94, 0.3)"},children:[e.jsx("h4",{style:{fontSize:"14px",fontWeight:"600",color:"#22c55e",marginBottom:"12px"},children:"Cash Injection Summary"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"8px",fontSize:"14px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#10b981"},children:"Type:"}),e.jsx("span",{style:{fontWeight:"600",color:"#ebebeb"},children:n.type})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#10b981"},children:"Amount:"}),e.jsx("span",{style:{fontWeight:"600",color:"#ebebeb"},children:D(n.amount)})]}),s?.requiresPartner&&n.partnerId&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#10b981"},children:"Partner:"}),e.jsx("span",{style:{fontWeight:"600",color:"#ebebeb"},children:k.find(t=>t.id===n.partnerId)?.name})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{color:"#10b981"},children:"Date:"}),e.jsx("span",{style:{fontWeight:"600",color:"#ebebeb"},children:new Date(n.date).toLocaleDateString()})]})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"12px",paddingTop:"16px",borderTop:"1px solid #404040",marginTop:"8px"},children:[e.jsx("button",{type:"button",onClick:y,disabled:b,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#b3b3b3",backgroundColor:"transparent",border:"1px solid #404040",borderRadius:"6px",cursor:b?"not-allowed":"pointer",opacity:b?.5:1,transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:t=>{b||(t.target.style.backgroundColor="rgba(255, 255, 255, 0.05)",t.target.style.color="#ebebeb")},onMouseLeave:t=>{b||(t.target.style.backgroundColor="transparent",t.target.style.color="#b3b3b3")},children:"Cancel"}),e.jsx("button",{type:"submit",disabled:b,style:{padding:"8px 16px",fontSize:"14px",fontWeight:"500",color:"#ffffff",backgroundColor:"#22c55e",border:"none",borderRadius:"6px",cursor:b?"not-allowed":"pointer",opacity:b?.5:1,transition:"all 0.2s",whiteSpace:"nowrap"},onMouseEnter:t=>{b||(t.target.style.backgroundColor="#16a34a")},onMouseLeave:t=>{b||(t.target.style.backgroundColor="#22c55e")},children:b?"Processing...":d?"Update Injection":"Add Cash Injection"})]})]})]})})}function Se(){const{cashInjections:d=[],partners:y,deleteCashInjection:k}=M(),{showSuccessMessage:S,showErrorMessage:N,showConfirmDialog:C}=O(),[u,n]=I.useState(!1),[p,r]=I.useState(null),[j,b]=I.useState("all"),w=[...j==="all"?d:d.filter(i=>i.type===j)].sort((i,g)=>new Date(g.date)-new Date(i.date)),s=d.reduce((i,g)=>(i[g.type]=(i[g.type]||0)+g.amount,i),{}),f=Object.values(s).reduce((i,g)=>i+g,0),o=i=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(i||0),m=i=>{r(i),n(!0)},D=async i=>{if(await C("Delete Cash Injection",`Are you sure you want to delete this ${o(i.amount)} ${i.type.toLowerCase()}? ${i.type==="Capital Contribution"?"This will also update the partner's equity account.":"This action cannot be undone."}`))try{await k(i.id),S("Injection Deleted","Cash injection has been removed successfully")}catch(F){N("Delete Failed",F.message||"Failed to delete cash injection")}},t=i=>{switch(i){case"Capital Contribution":return e.jsx(X,{className:"h-5 w-5 text-purple-600"});case"Loan":return e.jsx(re,{className:"h-5 w-5 text-orange-600"});case"Other Income":return e.jsx(U,{className:"h-5 w-5 text-green-600"});case"Opening Balance":return e.jsx(te,{className:"h-5 w-5 text-blue-600"});default:return e.jsx(V,{className:"h-5 w-5 text-gray-600"})}},x=i=>{switch(i){case"Capital Contribution":return"bg-purple-100 text-purple-800";case"Loan":return"bg-orange-100 text-orange-800";case"Other Income":return"bg-green-100 text-green-800";case"Opening Balance":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"500",color:"#ebebeb"},children:"Cash Injections"}),e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3",marginTop:"4px"},children:"Track capital contributions, loans, and other cash additions"})]}),e.jsxs("button",{onClick:()=>{r(null),n(!0)},className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Add Cash Injection"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{style:{backgroundColor:"#3a3a3a",padding:"16px",borderRadius:"8px",border:"1px solid #525252"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3"},children:"Total Injections"}),e.jsx("p",{style:{fontSize:"20px",fontWeight:"600",color:"#ebebeb"},children:o(f)})]}),e.jsx(V,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{style:{backgroundColor:"#3a3a3a",padding:"16px",borderRadius:"8px",border:"1px solid #525252"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3"},children:"Capital Contributions"}),e.jsx("p",{className:"text-lg font-semibold text-purple-600",children:o(s["Capital Contribution"]||0)})]}),e.jsx(X,{className:"h-8 w-8 text-purple-500"})]})}),e.jsx("div",{style:{backgroundColor:"#3a3a3a",padding:"16px",borderRadius:"8px",border:"1px solid #525252"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3"},children:"Loans"}),e.jsx("p",{className:"text-lg font-semibold text-orange-600",children:o(s.Loan||0)})]}),e.jsx(re,{className:"h-8 w-8 text-orange-500"})]})}),e.jsx("div",{style:{backgroundColor:"#3a3a3a",padding:"16px",borderRadius:"8px",border:"1px solid #525252"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3"},children:"Other Income"}),e.jsx("p",{className:"text-lg font-semibold text-green-600",children:o(s["Other Income"]||0)})]}),e.jsx(U,{className:"h-8 w-8 text-green-500"})]})}),e.jsx("div",{style:{backgroundColor:"#3a3a3a",padding:"16px",borderRadius:"8px",border:"1px solid #525252"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3"},children:"Opening Balance"}),e.jsx("p",{className:"text-lg font-semibold text-blue-600",children:o(s["Opening Balance"]||0)})]}),e.jsx(te,{className:"h-8 w-8 text-blue-500"})]})})]}),e.jsx("div",{style:{borderBottom:"1px solid #404040",marginBottom:"16px"},children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsxs("button",{onClick:()=>b("all"),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm",style:{borderBottomColor:j==="all"?"#2563eb":"transparent",color:j==="all"?"#2563eb":"#b3b3b3"},children:["All (",d.length,")"]}),["Capital Contribution","Loan","Other Income","Opening Balance"].map(i=>{const g=d.filter(F=>F.type===i).length;return e.jsxs("button",{onClick:()=>b(i),className:"whitespace-nowrap py-2 px-1 border-b-2 font-medium text-sm",style:{borderBottomColor:j===i?"#2563eb":"transparent",color:j===i?"#2563eb":"#b3b3b3"},children:[i," (",g,")"]},i)})]})}),w.length===0?e.jsxs("div",{style:{backgroundColor:"#3a3a3a",border:"1px solid #525252",borderRadius:"8px",padding:"32px",textAlign:"center"},children:[e.jsx(V,{className:"h-12 w-12 mx-auto mb-4",style:{color:"#6b7280"}}),e.jsx("h3",{style:{fontSize:"18px",fontWeight:"500",color:"#ebebeb",marginBottom:"8px"},children:"No Cash Injections"}),e.jsx("p",{style:{color:"#b3b3b3"},children:j==="all"?"No records found":`No ${j.toLowerCase()} records found`})]}):e.jsx("div",{style:{backgroundColor:"#3a3a3a",border:"1px solid #525252",borderRadius:"8px",overflow:"hidden"},children:e.jsx("ul",{style:{borderTop:"none"},children:w.map(i=>{const g=i.partnerId?y.find(F=>F.id===i.partnerId):null;return e.jsx("li",{children:e.jsx("div",{className:"px-4 py-4 sm:px-6",style:{borderBottom:"1px solid #404040"},onMouseEnter:F=>{F.currentTarget.style.backgroundColor="#4a4a4a"},onMouseLeave:F=>{F.currentTarget.style.backgroundColor="transparent"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:t(i.type)}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("p",{style:{fontSize:"14px",fontWeight:"500",color:"#ebebeb"},children:i.description}),e.jsx("span",{className:`ml-3 inline-flex px-2 py-0.5 text-xs font-semibold rounded-full ${x(i.type)}`,children:i.type})]}),e.jsxs("div",{className:"mt-1 flex items-center",style:{fontSize:"14px",color:"#b3b3b3"},children:[e.jsx("span",{children:q(i.date)}),e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{children:i.source}),g&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsx("span",{className:"text-purple-600",children:g.name})]}),i.reference&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"mx-2",children:"•"}),e.jsxs("span",{className:"flex items-center",children:[e.jsx(de,{className:"h-3 w-3 mr-1"}),i.reference]})]})]}),i.notes&&e.jsx("p",{className:"mt-1 italic",style:{fontSize:"12px",color:"#b3b3b3"},children:i.notes})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-right mr-4",children:e.jsxs("p",{className:"text-lg font-semibold text-green-600",children:["+",o(i.amount)]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>m(i),className:"hover:text-blue-400",style:{color:"#9ca3af"},title:"Edit injection",children:e.jsx(ae,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>D(i),className:"hover:text-red-400",style:{color:"#9ca3af"},title:"Delete injection",children:e.jsx(ee,{className:"h-4 w-4"})})]})]})]})})},i.id)})})}),u&&e.jsx(Ce,{injection:p,onClose:()=>{n(!1),r(null)}})]})}function We(){const{partners:d,withdrawals:y,cashFlows:k,cashInjections:S=[],sales:N,expenses:C,containers:u,syncFinanceData:n}=M(),{showSuccessMessage:p,showInfoMessage:r,showErrorMessage:j}=O(),b=()=>{try{const v=new URLSearchParams(window.location.search).get("tab"),a=localStorage.getItem("financeActiveTab"),z=["dashboard","injections","withdrawals","partners"],A=v||a||"dashboard";return z.includes(A)?A:"dashboard"}catch(c){return console.error("Error getting initial tab:",c),"dashboard"}},[l,w]=I.useState(b);I.useEffect(()=>{const c=b();c!==l&&w(c)},[]);const s=c=>{try{w(c);const v=new URL(window.location);v.searchParams.set("tab",c),window.history.pushState(null,"",v.toString()),localStorage.setItem("financeActiveTab",c)}catch(v){console.error("Error changing tab:",v),w(c)}},f=new Date().toISOString().split("T")[0],o=N.filter(c=>c.date===f),m=C.filter(c=>c.date===f),D=y.filter(c=>c.date===f),t=o.reduce((c,v)=>c+(v.totalAmount||0),0),x=m.reduce((c,v)=>c+v.amount,0)+D.reduce((c,v)=>c+v.amount,0),i=N.reduce((c,v)=>c+(v.totalAmount||0),0),g=S.reduce((c,v)=>c+(v.amount||0),0),F=C.reduce((c,v)=>c+v.amount,0),R=y.reduce((c,v)=>c+v.amount,0),P=i+g,W=i+g-F-R,_=d.reduce((c,v)=>{const a=v.capitalAccount||{};return c+(a.initialInvestment||0)+(a.profitShare||0)-(a.totalWithdrawn||0)},0),E=2e3,L=Math.max(0,W-E),T=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(c||0),J=[{id:"dashboard",name:"Cash Flow",icon:U},{id:"injections",name:"Cash Injections",icon:Q},{id:"withdrawals",name:"Withdrawals",icon:X},{id:"partners",name:"Partners",icon:oe}];return e.jsx("div",{className:"min-h-screen",children:e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"sm:max-w-7xl sm:mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{children:[e.jsx("h2",{style:{fontSize:"24px",fontWeight:"bold",color:"#ebebeb"},children:"Finance Management"}),e.jsx("p",{style:{fontSize:"14px",color:"#b3b3b3",marginTop:"4px"},children:"Manage cash flow, partner withdrawals, and equity distributions"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx($,{title:"Cash Position",value:T(W),subtitle:`${t>0?`+${T(t)} in`:""}${t>0&&x>0?" • ":""}${x>0?`-${T(x)} out`:""}`.trim()||"Current balance",icon:V,iconBgColor:"bg-green-100",iconColor:"text-green-600",trend:t-x>0?"up":t-x<0?"down":null}),e.jsx($,{title:"Available Distribution",value:T(L),subtitle:`Reserve: ${T(E)}`,icon:ue,iconBgColor:"bg-blue-100",iconColor:"text-blue-600"}),e.jsx($,{title:"Total Equity",value:T(_),subtitle:`${d.length} partner${d.length!==1?"s":""}`,icon:oe,iconBgColor:"bg-purple-100",iconColor:"text-purple-600"}),e.jsx($,{title:"Today's Withdrawals",value:T(D.reduce((c,v)=>c+v.amount,0)),subtitle:`${D.length} transaction${D.length!==1?"s":""}`,icon:X,iconBgColor:D.length>0?"bg-orange-100":"bg-gray-100",iconColor:D.length>0?"text-orange-600":"text-gray-600"})]}),e.jsxs("div",{style:{backgroundColor:"#2a2a2a",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",borderRadius:"8px",border:"1px solid #404040"},children:[e.jsx("div",{style:{borderBottom:"1px solid #404040"},children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6","aria-label":"Tabs",children:J.map(c=>{const v=c.icon;return e.jsxs("button",{onClick:()=>s(c.id),className:`
                        whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center justify-center sm:justify-start
                        ${l===c.id?"border-blue-500 text-blue-600":"border-transparent hover:border-gray-300"}
                      `,style:{color:l===c.id?"#2563eb":"#b3b3b3"},title:c.name,children:[e.jsx(v,{className:"h-5 w-5 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:c.name})]},c.id)})})}),e.jsxs("div",{className:"p-6",children:[l==="dashboard"&&e.jsx(ge,{currentCashPosition:W,openingBalance:P}),l==="injections"&&e.jsx(Se,{}),l==="withdrawals"&&e.jsx(fe,{availableCash:L}),l==="partners"&&e.jsx(ve,{})]})]})]})})})}export{We as default};
