import{c as G,j as e,X as H,u as J,d as Y,r as m,e as Z,E as ee,b as se}from"./index-BwFdBzJr.js";import{f as W}from"./dateFormatter-DEoQwZ0j.js";import te from"./ContainerForm-Dp-6rWB-.js";import{M as ae}from"./Modal-DEYZO-SD.js";import{P as B}from"./pencil-D8BEWyrg.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],le=G("archive",re);function ne({container:r,onClose:w,onEdit:C}){const n=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0),o=r.products?.reduce((t,l)=>t+(l.bagQuantity||0),0)||0,x=r.products?.reduce((t,l)=>t+(l.bagQuantity||0)*(l.bagWeight||25),0)||0,h=r.products?.reduce((t,l)=>t+(l.bagQuantity||0)*(l.costPerKg||0)*(l.bagWeight||25),0)||0,f=parseFloat(r.shippingCost)||0,u=parseFloat(r.customsCost)||0,g=h+f+u;return e.jsx(ae,{isOpen:!0,onClose:w,size:"large",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl p-5 max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-xl font-medium text-gray-900",children:["Container Details: ",r.id]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:C,className:"text-blue-600 hover:text-blue-800 p-2 rounded-md hover:bg-blue-50",title:"Edit container",children:e.jsx(B,{className:"h-5 w-5"})}),e.jsxs("button",{onClick:w,className:"text-gray-400 hover:text-gray-600 p-2",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(H,{className:"h-6 w-6"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Supplier"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:r.supplier})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Purchase Date"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:W(r.purchaseDate)})]}),r.invoiceNumber&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Invoice Number"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:r.invoiceNumber})]})]}),r.description&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-500",children:"Description"}),e.jsx("p",{className:"mt-1 text-gray-900",children:r.description})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white border rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:o}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total Bags"})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:x.toLocaleString()}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total Kg"})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:n(h)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Products Cost"})]})}),e.jsx("div",{className:"bg-white border rounded-lg p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:n(g)}),e.jsx("p",{className:"text-sm text-gray-500",children:"Total Investment"})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Products Purchased"}),r.products&&r.products.length>0?e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:r.products.map((t,l)=>{const y=(t.bagQuantity||0)*(t.bagWeight||25),p=(t.bagQuantity||0)*(t.costPerKg||0)*(t.bagWeight||25);return e.jsx("li",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h5",{className:"text-lg font-medium text-gray-900",children:t.productName}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:n(p)})]}),e.jsxs("div",{className:"mt-2 grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Quantity:"}),e.jsxs("p",{className:"text-gray-900",children:[t.bagQuantity," bags"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Weight:"}),e.jsxs("p",{className:"text-gray-900",children:[y," kg (",t.bagWeight,"kg/bag)"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Cost per Kg:"}),e.jsx("p",{className:"text-gray-900",children:n(t.costPerKg)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Cost per Bag:"}),e.jsx("p",{className:"text-gray-900",children:n((t.costPerKg||0)*(t.bagWeight||25))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-500",children:"Landed Cost/Bag:"}),e.jsx("p",{className:"text-gray-900 font-semibold",children:n((t.costPerKg||0)*(t.bagWeight||25)+(o>0?(f+u)/o:0))})]})]})]})})},l)})})}):e.jsx("div",{className:"text-center py-8 bg-white rounded-lg border",children:e.jsx("p",{className:"text-gray-500",children:"No products found in this container"})})]}),e.jsxs("div",{className:"mt-6 bg-gray-50 rounded-lg p-6",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Cost Breakdown"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Products Total:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n(h)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Shipping Cost:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n(f)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Customs/Clearing Cost:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n(u)})]}),e.jsx("div",{className:"border-t border-gray-200 pt-2",children:e.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[e.jsx("span",{className:"text-gray-900",children:"Total Container Cost:"}),e.jsx("span",{className:"text-gray-900",children:n(g)})]})})]}),x>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Average Landed Cost per Kg:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n(g/x)})]}),o>0&&e.jsxs("div",{className:"flex justify-between text-sm mt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Average Landed Cost per Bag:"}),e.jsx("span",{className:"font-medium text-gray-900",children:n(g/o)})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:w,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Close"}),e.jsx("button",{onClick:C,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Edit Container"})]})]})})})}function he(){const{containers:r,products:w,addContainer:C,updateContainer:n,deleteContainer:o,error:x,setError:h}=J(),{showSuccessMessage:f,showErrorMessage:u,showConfirmDialog:g}=Y(),[t,l]=m.useState(!1),[y,p]=m.useState(null),[P,F]=m.useState(null),[b,E]=m.useState(""),[j,M]=m.useState("purchaseDate"),[T,Q]=m.useState("desc");m.useEffect(()=>{x&&(u("Operation Failed",x),h(null))},[x,u,h]);const L=r.filter(s=>s.id.toLowerCase().includes(b.toLowerCase())||s.supplier.toLowerCase().includes(b.toLowerCase())||s.invoiceNumber?.toLowerCase().includes(b.toLowerCase())).sort((s,a)=>{let i=s[j],c=a[j];return j==="purchaseDate"?(i=new Date(i),c=new Date(c)):j==="totalCost"&&(i=parseFloat(i)||0,c=parseFloat(c)||0),T==="asc"?i>c?1:-1:i<c?1:-1}),N=r.length,V=r.reduce((s,a)=>s+(parseFloat(a.totalCost)||0),0),A=r.reduce((s,a)=>s+(a.products?.length||0),0),O=N>0?V/N:0,$=s=>{const a=s.products||[],i=a.length,c=a.reduce((v,d)=>v+(d.bagQuantity||0),0),K=a.reduce((v,d)=>v+(d.bagQuantity||0)*(d.bagWeight||25),0),q=a.reduce((v,d)=>v+(d.bagQuantity||0)*(d.costPerKg||0)*(d.bagWeight||25),0)+(parseFloat(s.shippingCost)||0)+(parseFloat(s.customsCost)||0);return{productCount:i,totalStock:c,totalKg:K,totalValue:q}},U=()=>{p(null),l(!0)},I=s=>{p(s),l(!0)},R=async s=>{const a=r.find(K=>K.id===s),i=a?`${a.id} (${a.supplier})`:s;await g(`Delete Container ${i}`,"Are you sure you want to delete this container? This will revert ALL stock that was added from this container. This action cannot be undone and may affect your inventory levels.","danger")&&o(s),f("Container Deleted",`Container ${i} has been deleted and stock has been reverted.`)},z=s=>{F(s)},_=async s=>{try{y?await n(y.id,s):await C(s),l(!1),p(null)}catch(a){console.error("Form submission error:",a)}},X=()=>{l(!1),p(null)},k=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0),S=s=>{j===s?Q(T==="asc"?"desc":"asc"):(M(s),Q("desc"))},D=s=>j!==s?null:e.jsx("svg",{className:`w-4 h-4 ml-1 ${T==="asc"?"transform rotate-180":""}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})});return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"py-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"md:flex md:items-center md:justify-between mb-6",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Container Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track and manage your import containers and their contents"})]}),e.jsx("div",{className:"mt-4 md:mt-0 md:ml-4",children:e.jsxs("button",{onClick:U,className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Add Container"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:N})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Containers"}),e.jsxs("dd",{className:"text-lg font-medium text-gray-900",children:[N," containers"]})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-xs",children:"$"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Investment"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:k(V)})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:A})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Products"}),e.jsxs("dd",{className:"text-lg font-medium text-gray-900",children:[A," items"]})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white font-semibold text-xs",children:"Avg"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Avg Container Value"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:k(O)})]})})]})})})]}),e.jsx("div",{className:"bg-white shadow rounded-lg mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex-1 max-w-lg",children:[e.jsx("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Containers"}),e.jsx("input",{type:"text",id:"search",value:b,onChange:s=>E(s.target.value),placeholder:"Search by ID, supplier, or invoice number...",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-700",children:["Showing ",L.length," of ",N," containers"]}),b&&e.jsx("button",{onClick:()=>E(""),className:"text-sm text-blue-600 hover:text-blue-800",children:"Clear search"})]})]})})}),L.length===0?e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[e.jsx(le,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No containers found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:N===0?"No containers added.":"Try adjusting your search criteria."})]}):e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("id"),children:e.jsxs("div",{className:"flex items-center",children:["Container ID",D("id")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("supplier"),children:e.jsxs("div",{className:"flex items-center",children:["Supplier",D("supplier")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("purchaseDate"),children:e.jsxs("div",{className:"flex items-center",children:["Purchase Date",D("purchaseDate")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Products"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100",onClick:()=>S("totalCost"),children:e.jsxs("div",{className:"flex items-center",children:["Total Cost",D("totalCost")]})}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Value"}),e.jsx("th",{scope:"col",className:"relative px-6 py-3",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L.map(s=>{const a=$(s);return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.id}),s.invoiceNumber&&e.jsxs("div",{className:"text-sm text-gray-500",children:["Invoice: ",s.invoiceNumber]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.supplier}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W(s.purchaseDate)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-gray-900",children:[a.productCount," ",a.productCount===1?"product":"products"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[a.totalStock," bags (",a.totalKg,"kg)"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:k(s.totalCost)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:k(a.totalValue)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>z(s),className:"text-green-600 hover:text-green-900 p-1 rounded-md hover:bg-green-50",title:"View details",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>I(s),className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50",title:"Edit container",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>R(s.id),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50",title:"Delete container",children:e.jsx(se,{className:"h-4 w-4"})})]})})]},s.id)})})]})})})]})}),t&&e.jsx(te,{container:y,onSubmit:_,onCancel:X}),P&&e.jsx(ne,{container:P,onClose:()=>F(null),onEdit:()=>{F(null),I(P)}})]})}export{he as default};
