import{c as q,u as z,d as G,r as h,j as e,b as J,e as K,D as _,R as ee}from"./index-BwFdBzJr.js";import se from"./ExpenseForm-DXTc7ypz.js";import{f as te}from"./dateFormatter-DEoQwZ0j.js";import{S as ae}from"./search-Dot_9-a0.js";import{P as re}from"./pencil-D8BEWyrg.js";import{C as le,a as ne,b as oe}from"./chevrons-right-DJ7i67f5.js";import{C as ce}from"./chevron-right-WOTLQ4LS.js";import"./Modal-DEYZO-SD.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],ie=q("chart-pie",de);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]],me=q("file-x",xe);function he({onEditExpense:N}){const{expenses:E,deleteExpense:C}=z(),{showSuccessMessage:I,showErrorMessage:k,showConfirmDialog:A}=G(),[i,S]=h.useState(""),[p,b]=h.useState(""),[y,x]=h.useState(""),[u,g]=h.useState(""),[D,O]=h.useState("date"),[v,f]=h.useState("desc"),[t,a]=h.useState(1),[o,L]=h.useState(10),H=[...new Set(E.map(s=>s.category))].sort(),j=E.filter(s=>{const l=!i||s.description?.toLowerCase().includes(i.toLowerCase())||s.notes?.toLowerCase().includes(i.toLowerCase())||s.containerId?.toLowerCase().includes(i.toLowerCase()),n=!p||s.category===p,d=!y||s.date>=y,c=!u||s.date<=u;return l&&n&&d&&c}).sort((s,l)=>{let n,d;switch(D){case"amount":n=s.amount||0,d=l.amount||0;break;case"category":n=s.category||"",d=l.category||"";break;case"date":default:n=new Date(s.date),d=new Date(l.date);break}return v==="desc"?d>n?1:-1:n>d?1:-1}),w=j.length,r=Math.ceil(w/o),F=(t-1)*o,$=F+o,M=j.slice(F,$),V=()=>{const l=[],n=[];let d;for(let c=1;c<=r;c++)(c===1||c===r||c>=t-2&&c<=t+2)&&l.push(c);return l.forEach(c=>{d&&(c-d===2?n.push(d+1):c-d!==1&&n.push("...")),n.push(c),d=c}),n},m=s=>{s>=1&&s<=r&&(a(s),window.scrollTo({top:0,behavior:"smooth"}))},U=s=>{L(Number(s)),a(1)},B=async s=>{if(await A("Delete Expense",`Are you sure you want to delete this ${s.category} expense for ${T(s.amount)}?`))try{await C(s.id),I("Expense Deleted","Expense has been deleted successfully")}catch(n){console.error("Delete expense error:",n),k("Delete Failed",n.message||"Failed to delete expense")}},T=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0),W=j.reduce((s,l)=>s+(l.amount||0),0),Y=M.reduce((s,l)=>s+(l.amount||0),0),R=new Date().toISOString().split("T")[0],Q=new Date().toISOString().substring(0,7),X=new Date(new Date().getFullYear(),new Date().getMonth()-1,1).toISOString().split("T")[0],Z=new Date(new Date().getFullYear(),new Date().getMonth(),0).toISOString().split("T")[0],P=s=>{switch(a(1),s){case"today":x(R),g(R);break;case"thisMonth":x(Q+"-01"),g(R);break;case"lastMonth":x(X),g(Z);break;case"clear":x(""),g("");break}};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Expense History"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[j.length," expense",j.length!==1?"s":""," • ",T(W)," total"]}),r>1&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Page ",t,": ",M.length," expense",M.length!==1?"s":""," • ",T(Y)]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[e.jsx("div",{className:"col-span-1 sm:col-span-2 lg:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:i,onChange:s=>{S(s.target.value),a(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("select",{value:p,onChange:s=>{b(s.target.value),a(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),H.map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsxs("div",{className:"col-span-1 flex gap-2",children:[e.jsxs("select",{value:D,onChange:s=>O(s.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"amount",children:"Amount"}),e.jsx("option",{value:"category",children:"Category"})]}),e.jsx("button",{onClick:()=>f(v==="desc"?"asc":"desc"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",title:`Sort ${v==="desc"?"ascending":"descending"}`,children:v==="desc"?"↓":"↑"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"From:"}),e.jsx("input",{type:"date",value:y,onChange:s=>{x(s.target.value),a(1)},className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"To:"}),e.jsx("input",{type:"date",value:u,onChange:s=>{g(s.target.value),a(1)},className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>P("today"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Today"}),e.jsx("button",{onClick:()=>P("thisMonth"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"This Month"}),e.jsx("button",{onClick:()=>P("lastMonth"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Last Month"}),e.jsx("button",{onClick:()=>P("clear"),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Clear Dates"})]}),(i||p||y||u)&&e.jsx("button",{onClick:()=>{S(""),b(""),x(""),g("")},className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900 underline sm:ml-auto",children:"Clear All"})]})]})]}),j.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Container"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:te(s.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s.category})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.description}),s.notes&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",title:s.notes,children:s.notes})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:T(s.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.containerId||"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>N(s),className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50",title:"Edit expense",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(s),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50",title:"Delete expense",children:e.jsx(J,{className:"h-4 w-4"})})]})})]},s.id))})]}),r>1&&e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-t",children:[e.jsxs("div",{className:"sm:hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",t," of ",r]}),e.jsxs("select",{value:o,onChange:s=>U(s.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded",children:[e.jsx("option",{value:"10",children:"10/page"}),e.jsx("option",{value:"25",children:"25/page"}),e.jsx("option",{value:"50",children:"50/page"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("button",{onClick:()=>m(t-1),disabled:t===1,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>m(1),className:`px-2 py-1 text-sm rounded ${t===1?"bg-blue-600 text-white":"text-gray-700"}`,children:"1"}),t>3&&e.jsx("span",{className:"px-1 text-gray-500",children:"..."}),t>2&&t<r-1&&e.jsx("button",{onClick:()=>m(t),className:"px-2 py-1 text-sm bg-blue-600 text-white rounded",children:t}),t<r-2&&e.jsx("span",{className:"px-1 text-gray-500",children:"..."}),r>1&&e.jsx("button",{onClick:()=>m(r),className:`px-2 py-1 text-sm rounded ${t===r?"bg-blue-600 text-white":"text-gray-700"}`,children:r})]}),e.jsx("button",{onClick:()=>m(t+1),disabled:t===r,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-2",children:[F+1,"-",Math.min($,w)," of ",w]})]}),e.jsxs("div",{className:"hidden sm:flex sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show:"}),e.jsxs("select",{value:o,onChange:s=>U(s.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsxs("option",{value:j.length,children:["All (",j.length,")"]})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"per page"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>m(1),disabled:t===1,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"First page",children:e.jsx(le,{className:"h-4 w-4 text-gray-600"})}),e.jsx("button",{onClick:()=>m(t-1),disabled:t===1,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous page",children:e.jsx(ne,{className:"h-4 w-4 text-gray-600"})}),e.jsx("div",{className:"flex items-center space-x-1 mx-2",children:V().map((s,l)=>s==="..."?e.jsx("span",{className:"px-2 py-1 text-sm text-gray-500",children:"..."},`dots-${l}`):e.jsx("button",{onClick:()=>m(s),className:`px-3 py-1 text-sm rounded ${t===s?"bg-blue-600 text-white":"hover:bg-gray-200 text-gray-700"}`,children:s},s))}),e.jsx("button",{onClick:()=>m(t+1),disabled:t===r,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Next page",children:e.jsx(ce,{className:"h-4 w-4 text-gray-600"})}),e.jsx("button",{onClick:()=>m(r),disabled:t===r,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Last page",children:e.jsx(oe,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",F+1," to ",Math.min($,w)," of ",w," expense",w!==1?"s":""]})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Expenses Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:i||p||y||u?"No expenses match your current filters.":"No expenses recorded."}),(i||p||y||u)&&e.jsx("button",{onClick:()=>{S(""),b(""),x(""),g("")},className:"text-blue-600 hover:text-blue-500",children:"Clear filters"})]})]})}function ve(){const{expenses:N}=z(),[E,C]=h.useState(!1),[I,k]=h.useState(null),A=new Date().toISOString().split("T")[0],i=N.filter(t=>t.date&&t.date===A),S=i.reduce((t,a)=>{const o=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return t+o},0),p=new Date().toISOString().substring(0,7),b=N.filter(t=>t.date&&t.date.startsWith(p)),y=b.reduce((t,a)=>{const o=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return t+o},0),x=b.reduce((t,a)=>{const o=a.category||"Miscellaneous",L=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return t[o]=(t[o]||0)+L,t},{}),u=Object.keys(x).length>0?Object.entries(x).sort(([,t],[,a])=>a-t)[0]:["No expenses",0],g=N.reduce((t,a)=>{const o=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return t+o},0),D=()=>{k(null),C(!0)},O=t=>{k(t),C(!0)},v=()=>{C(!1),k(null)},f=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Expense Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track business expenses and monitor spending by category"})]}),e.jsxs("button",{onClick:D,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(_,{className:"h-8 w-8 text-red-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Today's Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(S||0)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[i.length||0," transaction",i.length!==1?"s":""]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ee,{className:"h-8 w-8 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Monthly Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(y||0)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[b.length||0," transaction",b.length!==1?"s":""]})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(ie,{className:"h-8 w-8 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Top Category"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(u[1]||0)}),e.jsx("p",{className:"text-sm text-gray-600",children:u[0]||"No expenses"})]})]})}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(_,{className:"h-8 w-8 text-gray-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f(g||0)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[N.length||0," all time"]})]})]})})]}),Object.keys(x).length>0&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"This Month by Category"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(x).sort(([,t],[,a])=>a-t).map(([t,a])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:f(a)})]},t))})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsx(he,{onEditExpense:O})}),E&&e.jsx(se,{expense:I,onClose:v})]})}export{ve as default};
