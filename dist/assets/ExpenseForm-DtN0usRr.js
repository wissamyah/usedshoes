import{u as v,d as E,r as i,j as e,X as S}from"./index-bOp1r2QL.js";import{f as D}from"./dateFormatter-DEoQwZ0j.js";import{M as I}from"./Modal-CRPkkT7Z.js";function A({expense:a,onClose:d}){const{addExpense:u,deleteExpense:f}=v(),{showSuccessMessage:m,showErrorMessage:g}=E(),[s,x]=i.useState({category:"Transport",description:"",amount:"",date:new Date().toISOString().split("T")[0],containerId:"",notes:""}),[r,b]=i.useState({}),[l,p]=i.useState(!1),h=["Transport","Rent","Staff Salaries","Miscellaneous","Marketing","Utilities","Financial Expenses","Taxes","Discount"];i.useEffect(()=>{a&&x({category:a.category||"Transport",description:a.description||"",amount:a.amount?.toString()||"",date:a.date||new Date().toISOString().split("T")[0],containerId:a.containerId||"",notes:a.notes||""})},[a]);const n=t=>{const{name:o,value:w}=t.target;x(c=>({...c,[o]:w})),r[o]&&b(c=>({...c,[o]:""}))},y=()=>{const t={};return s.category||(t.category="Please select a category"),s.description.trim()||(t.description="Description is required"),s.amount?parseFloat(s.amount)<=0&&(t.amount="Amount must be greater than 0"):t.amount="Amount is required",s.date||(t.date="Date is required"),b(t),Object.keys(t).length===0},j=async t=>{if(t.preventDefault(),!!y()){p(!0);try{const o={category:s.category,description:s.description.trim(),amount:parseFloat(s.amount),date:s.date,containerId:s.containerId||null,notes:s.notes.trim()};a?(await f(a.id),await u(o),m("Expense Updated","Expense has been updated successfully")):(await u(o),m("Expense Added","New expense has been recorded successfully")),d()}catch(o){console.error("Expense submission error:",o),g("Expense Failed",o.message||"Failed to record expense")}finally{p(!1)}}},N=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0);return e.jsx(I,{isOpen:!0,onClose:d,size:"medium",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl p-5",children:e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a?"Edit Expense":"Add New Expense"}),e.jsxs("button",{onClick:d,className:"text-gray-400 hover:text-gray-600",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx(S,{className:"h-6 w-6"})]})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),e.jsx("select",{id:"category",name:"category",value:s.category,onChange:n,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${r.category?"border-red-300 focus:border-red-500":"border-gray-300 focus:border-blue-500"}`,children:h.map(t=>e.jsx("option",{value:t,children:t},t))}),r.category&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.category})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount ($) *"}),e.jsx("input",{type:"number",id:"amount",name:"amount",value:s.amount,onChange:n,min:"0",step:"0.01",className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${r.amount?"border-red-300 focus:border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"0.00"}),r.amount&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.amount})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),e.jsx("input",{type:"text",id:"description",name:"description",value:s.description,onChange:n,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${r.description?"border-red-300 focus:border-red-500":"border-gray-300 focus:border-blue-500"}`,placeholder:"Brief description of the expense..."}),r.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.description})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"date",className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",id:"date",name:"date",value:s.date,onChange:n,className:`w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${r.date?"border-red-300 focus:border-red-500":"border-gray-300 focus:border-blue-500"}`}),r.date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.date})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"containerId",className:"block text-sm font-medium text-gray-700 mb-1",children:"Container ID"}),e.jsx("input",{type:"text",id:"containerId",name:"containerId",value:s.containerId,onChange:n,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Optional container reference"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Link to specific container (optional)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Additional Notes"}),e.jsx("textarea",{id:"notes",name:"notes",value:s.notes,onChange:n,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Additional details, receipts, etc..."})]}),s.amount&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Expense Summary"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Category:"}),e.jsx("span",{className:"font-semibold text-blue-900",children:s.category})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Amount:"}),e.jsx("span",{className:"font-semibold text-blue-900",children:N(s.amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Date:"}),e.jsx("span",{className:"font-semibold text-blue-900",children:D(s.date)})]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:d,disabled:l,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Processing...":a?"Update Expense":"Add Expense"})]})]})]})})})}export{A as default};
