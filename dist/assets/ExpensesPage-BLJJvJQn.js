import{c as _,u as q,d as G,r as u,j as e,b as J,e as K,R as ee,D as te}from"./index-CnsNA1Vq.js";import se from"./ExpenseForm-CZ-DPPGs.js";import{f as ae}from"./dateFormatter-DEoQwZ0j.js";import{S as re}from"./search-ClOXqdvH.js";import{P as ne}from"./pencil-DtMxSY_x.js";import{C as le,a as oe,b as ce}from"./chevrons-right-BUyXEodM.js";import{C as ie}from"./chevron-right-CJK63UVS.js";import{S as I}from"./StatCard-BhXAGQ8R.js";import{C as de}from"./chart-pie-ioZsGn-W.js";import"./Modal-Dw5js9Bu.js";/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],me=_("credit-card",xe);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]],he=_("file-x",ue);function ge({onEditExpense:N}){const{expenses:E,deleteExpense:k}=q(),{showSuccessMessage:$,showErrorMessage:S,showConfirmDialog:O}=G(),[d,v]=u.useState(""),[p,b]=u.useState(""),[y,x]=u.useState(""),[h,g]=u.useState(""),[D,A]=u.useState("date"),[w,j]=u.useState("desc"),[s,a]=u.useState(1),[o,L]=u.useState(10),H=[...new Set(E.map(t=>t.category))].sort(),f=E.filter(t=>{const n=!d||t.description?.toLowerCase().includes(d.toLowerCase())||t.notes?.toLowerCase().includes(d.toLowerCase())||t.containerId?.toLowerCase().includes(d.toLowerCase()),l=!p||t.category===p,i=!y||t.date>=y,c=!h||t.date<=h;return n&&l&&i&&c}).sort((t,n)=>{let l,i;switch(D){case"amount":l=t.amount||0,i=n.amount||0;break;case"category":l=t.category||"",i=n.category||"";break;case"date":default:l=new Date(t.date),i=new Date(n.date);break}return w==="desc"?i>l?1:-1:l>i?1:-1}),C=f.length,r=Math.ceil(C/o),F=(s-1)*o,B=F+o,M=f.slice(F,B),V=()=>{const n=[],l=[];let i;for(let c=1;c<=r;c++)(c===1||c===r||c>=s-2&&c<=s+2)&&n.push(c);return n.forEach(c=>{i&&(c-i===2?l.push(i+1):c-i!==1&&l.push("...")),l.push(c),i=c}),l},m=t=>{t>=1&&t<=r&&(a(t),window.scrollTo({top:0,behavior:"smooth"}))},U=t=>{L(Number(t)),a(1)},z=async t=>{if(await O("Delete Expense",`Are you sure you want to delete this ${t.category} expense for ${T(t.amount)}?`))try{await k(t.id),$("Expense Deleted","Expense has been deleted successfully")}catch(l){console.error("Delete expense error:",l),S("Delete Failed",l.message||"Failed to delete expense")}},T=t=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t||0),W=f.reduce((t,n)=>t+(n.amount||0),0),Y=M.reduce((t,n)=>t+(n.amount||0),0),R=new Date().toISOString().split("T")[0],Q=new Date().toISOString().substring(0,7),X=new Date(new Date().getFullYear(),new Date().getMonth()-1,1).toISOString().split("T")[0],Z=new Date(new Date().getFullYear(),new Date().getMonth(),0).toISOString().split("T")[0],P=t=>{switch(a(1),t){case"today":x(R),g(R);break;case"thisMonth":x(Q+"-01"),g(R);break;case"lastMonth":x(X),g(Z);break;case"clear":x(""),g("");break}};return e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Expense History"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[f.length," expense",f.length!==1?"s":""," • ",T(W)," total"]}),r>1&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Page ",s,": ",M.length," expense",M.length!==1?"s":""," • ",T(Y)]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 mb-4",children:[e.jsx("div",{className:"col-span-1 sm:col-span-2 lg:col-span-2",children:e.jsxs("div",{className:"relative",children:[e.jsx(re,{className:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search...",value:d,onChange:t=>{v(t.target.value),a(1)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"})]})}),e.jsx("div",{className:"col-span-1",children:e.jsxs("select",{value:p,onChange:t=>{b(t.target.value),a(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),H.map(t=>e.jsx("option",{value:t,children:t},t))]})}),e.jsxs("div",{className:"col-span-1 flex gap-2",children:[e.jsxs("select",{value:D,onChange:t=>A(t.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"amount",children:"Amount"}),e.jsx("option",{value:"category",children:"Category"})]}),e.jsx("button",{onClick:()=>j(w==="desc"?"asc":"desc"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",title:`Sort ${w==="desc"?"ascending":"descending"}`,children:w==="desc"?"↓":"↑"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"From:"}),e.jsx("input",{type:"date",value:y,onChange:t=>{x(t.target.value),a(1)},className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"To:"}),e.jsx("input",{type:"date",value:h,onChange:t=>{g(t.target.value),a(1)},className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>P("today"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Today"}),e.jsx("button",{onClick:()=>P("thisMonth"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"This Month"}),e.jsx("button",{onClick:()=>P("lastMonth"),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Last Month"}),e.jsx("button",{onClick:()=>P("clear"),className:"px-3 py-1 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Clear Dates"})]}),(d||p||y||h)&&e.jsx("button",{onClick:()=>{v(""),b(""),x(""),g("")},className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-900 underline sm:ml-auto",children:"Clear All"})]})]})]}),f.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Container"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:ae(t.date)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t.category})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.description}),t.notes&&e.jsx("div",{className:"text-sm text-gray-500 truncate max-w-xs",title:t.notes,children:t.notes})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:T(t.amount)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.containerId||"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>N(t),className:"text-blue-600 hover:text-blue-900 p-1 rounded-md hover:bg-blue-50",title:"Edit expense",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>z(t),className:"text-red-600 hover:text-red-900 p-1 rounded-md hover:bg-red-50",title:"Delete expense",children:e.jsx(J,{className:"h-4 w-4"})})]})})]},t.id))})]}),r>1&&e.jsxs("div",{className:"bg-gray-50 px-4 py-3 border-t",children:[e.jsxs("div",{className:"sm:hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Page ",s," of ",r]}),e.jsxs("select",{value:o,onChange:t=>U(t.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded",children:[e.jsx("option",{value:"10",children:"10/page"}),e.jsx("option",{value:"25",children:"25/page"}),e.jsx("option",{value:"50",children:"50/page"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("button",{onClick:()=>m(s-1),disabled:s===1,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>m(1),className:`px-2 py-1 text-sm rounded ${s===1?"bg-blue-600 text-white":"text-gray-700"}`,children:"1"}),s>3&&e.jsx("span",{className:"px-1 text-gray-500",children:"..."}),s>2&&s<r-1&&e.jsx("button",{onClick:()=>m(s),className:"px-2 py-1 text-sm bg-blue-600 text-white rounded",children:s}),s<r-2&&e.jsx("span",{className:"px-1 text-gray-500",children:"..."}),r>1&&e.jsx("button",{onClick:()=>m(r),className:`px-2 py-1 text-sm rounded ${s===r?"bg-blue-600 text-white":"text-gray-700"}`,children:r})]}),e.jsx("button",{onClick:()=>m(s+1),disabled:s===r,className:"px-3 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"text-center text-xs text-gray-500 mt-2",children:[F+1,"-",Math.min(B,C)," of ",C]})]}),e.jsxs("div",{className:"hidden sm:flex sm:justify-between sm:items-center",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Show:"}),e.jsxs("select",{value:o,onChange:t=>U(t.target.value),className:"px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"10",children:"10"}),e.jsx("option",{value:"25",children:"25"}),e.jsx("option",{value:"50",children:"50"}),e.jsx("option",{value:"100",children:"100"}),e.jsxs("option",{value:f.length,children:["All (",f.length,")"]})]}),e.jsx("span",{className:"text-sm text-gray-700",children:"per page"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>m(1),disabled:s===1,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"First page",children:e.jsx(le,{className:"h-4 w-4 text-gray-600"})}),e.jsx("button",{onClick:()=>m(s-1),disabled:s===1,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Previous page",children:e.jsx(oe,{className:"h-4 w-4 text-gray-600"})}),e.jsx("div",{className:"flex items-center space-x-1 mx-2",children:V().map((t,n)=>t==="..."?e.jsx("span",{className:"px-2 py-1 text-sm text-gray-500",children:"..."},`dots-${n}`):e.jsx("button",{onClick:()=>m(t),className:`px-3 py-1 text-sm rounded ${s===t?"bg-blue-600 text-white":"hover:bg-gray-200 text-gray-700"}`,children:t},t))}),e.jsx("button",{onClick:()=>m(s+1),disabled:s===r,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Next page",children:e.jsx(ie,{className:"h-4 w-4 text-gray-600"})}),e.jsx("button",{onClick:()=>m(r),disabled:s===r,className:"p-1.5 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed",title:"Last page",children:e.jsx(ce,{className:"h-4 w-4 text-gray-600"})})]}),e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",F+1," to ",Math.min(B,C)," of ",C," expense",C!==1?"s":""]})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(he,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Expenses Found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:d||p||y||h?"No expenses match your current filters.":"No expenses recorded."}),(d||p||y||h)&&e.jsx("button",{onClick:()=>{v(""),b(""),x(""),g("")},className:"text-blue-600 hover:text-blue-500",children:"Clear filters"})]})]})}function Se(){const{expenses:N}=q(),[E,k]=u.useState(!1),[$,S]=u.useState(null),O=new Date().toISOString().split("T")[0],d=N.filter(s=>s.date&&s.date===O),v=d.reduce((s,a)=>{const o=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return s+o},0),p=new Date().toISOString().substring(0,7),b=N.filter(s=>s.date&&s.date.startsWith(p)),y=b.reduce((s,a)=>{const o=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return s+o},0),x=b.reduce((s,a)=>{const o=a.category||"Miscellaneous",L=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return s[o]=(s[o]||0)+L,s},{}),h=Object.keys(x).length>0?Object.entries(x).sort(([,s],[,a])=>a-s)[0]:["No expenses",0],g=N.reduce((s,a)=>{const o=typeof a.amount=="number"?a.amount:parseFloat(a.amount)||0;return s+o},0),D=()=>{S(null),k(!0)},A=s=>{S(s),k(!0)},w=()=>{k(!1),S(null)},j=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s||0);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Expense Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Track business expenses and monitor spending by category"})]}),e.jsxs("button",{onClick:D,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Add Expense"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[e.jsx(I,{title:"Today's Expenses",value:j(v||0),subtitle:`${d.length||0} transaction${d.length!==1?"s":""}`,icon:me,iconBgColor:"bg-red-100",iconColor:"text-red-600",trend:v>0?"up":null}),e.jsx(I,{title:"Monthly Expenses",value:j(y||0),subtitle:`${b.length||0} transaction${b.length!==1?"s":""}`,icon:ee,iconBgColor:"bg-orange-100",iconColor:"text-orange-600"}),e.jsx(I,{title:"Top Category",value:j(h[1]||0),subtitle:h[0]||"No expenses",icon:de,iconBgColor:"bg-purple-100",iconColor:"text-purple-600"}),e.jsx(I,{title:"Total Expenses",value:j(g||0),subtitle:`${N.length||0} all time`,icon:te,iconBgColor:"bg-gray-100",iconColor:"text-gray-600"})]}),Object.keys(x).length>0&&e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"This Month by Category"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(x).sort(([,s],[,a])=>a-s).map(([s,a])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"font-medium text-gray-900",children:s}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:j(a)})]},s))})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:e.jsx(ge,{onEditExpense:A})}),E&&e.jsx(se,{expense:$,onClose:w})]})}export{Se as default};
